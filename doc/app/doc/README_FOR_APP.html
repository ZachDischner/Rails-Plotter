<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">

<title>README_FOR_APP - Rails Application Documentation</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body class="file">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../doc/README_FOR_APP.html">README_FOR_APP</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../ApplicationController.html">ApplicationController</a>
  
    <li><a href="../ApplicationHelper.html">ApplicationHelper</a>
  
    <li><a href="../Plot.html">Plot</a>
  
    <li><a href="../PlotsController.html">PlotsController</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation" class="description">
  
<h1 id="label-Introduction">Introduction</h1>

<p>Welcome to the interactive database plotting web engine, built in Ruby on
Rails. If you’re reading this, then its likely you are trying to connect
this app with your database. This readme assumes you have some knowledge of
Ruby on Rails. If you don’t, online resources can be great teachers. Most
of what you’re about to read shouldn’t require much RoR insight, and the
demo should be comprehendible even for noobs.</p>

<p>This was built for the Laboratory for Atmospheric and Space Physics (LASP)
in Boulder, Colorado. Its AIM is to enable quick visulization of database
numeric data, without spending months developing your own custom solutions.
Since LASP has a diverse scientific community, using many different
database engines and schemas, I tried to make this app as generic as I
could, so that it may work for any of them. The goal is that this app will
provide a startup web server for any basic *single table* database table in
under 2 hours. Most of that time will be installing RoR dependencies. Once
set up, you should be able to run the server for your database within 10
minutes, with only minimal adjustments to the code itself.</p>

<p>To date (July 1 2012), I have successfully tested this app with the
following databases:</p>
<ul><li>
<p>MySQL</p>
</li><li>
<p>PostgreSQL</p>
</li><li>
<p>SQLite</p>
</li></ul>

<p>it should perform for other setups as well, but they have not been examined
yet.</p>

<h2 id="label-Architecture">Architecture</h2>

<p>The architecture of this application is pretty simple, and there are really
only 4 real pieces of code.</p>

<p>1.0 Selector View: An HTML page that contains selectors, tied to database
information. This is where you use HTML elements to essentially build your
database query. These elements include:</p>
<ul><li>
<p>X axis variable</p>
</li><li>
<p>Y axis variable(s)</p>
</li><li>
<p>Different plot sets or filters (optional)</p>
</li><li>
<p>X axis range selector using a numeric indicator (optional)</p>
</li><li>
<p>X axis range selector using a date indicator (optional)</p>
</li><li>
<p>Feature selector, enables different plot features aimed to help interaction</p>
</li></ul>

<p>This page is found in <strong>/app/views/plots/index.html.erb</strong></p>

<p>2.0 <a href="../Plot.html">Plot</a> View: An HTML page that takes a data
set obtained from your database, and from it renders interactive Dygraphs
plots. This page is found in 
<strong>/app/views/plots/plotter.html.erb</strong></p>

<p>3.0 Controller: Ruby file that grabs DB data necessary to construct HTML
pages, and handles lots of the login requried in that selection. Here,
there are only two pages. There are two methods, one for the Selector page,
and one for the <a href="../Plot.html">Plot</a> page. This file is found in
<strong>/app/controllers/plots_controller.rb</strong></p>

<p>4.0 <a href="../Plot.html">Plot</a> Class: Ruby file that contains all the
business logic of this application. The methods defined within are used
throughout the plotting process to fetch, parse, and regulate plot data.
This file is found in <strong>/app/models/plot.rb</strong></p>

<p>All files are well documented. Please review said documentation to get a
better understanding of how it all works. Logic, rendering, and selection
are all kept separate as much as possible. The way its laid out now, this
app should be portable to other project platforms, such as Django.</p>

<h1 id="label-Setup">Setup</h1>

<p>The best way to get started is to load up a demo and try it out. BEWARE,
The hardest thing is getting Ruby/Ruby on Rails and RoR + Databases to work
cohesively.</p>

<h2 id="label-Environment">Environment</h2>

<p>Obviously, you’ll need to have Ruby, Ruby on Rails, and a Database client
installed on your machine. SQLite and MYSQL sample databases are included
with this app for testing.  You <strong>must</strong> have MySQL installed
on your machine in order to for *&gt;&gt;bundle install* to work correctly.</p>

<p>Getting Ruby/RoR is notoriously difficult for some reason, though in
practice it should be very simple. Here is a basic tutorial: <a
href="http://eddorre.com/posts/rails-ultimate-install-guide-on-os-x-lion-using-rvm-homebrew-and-pow">eddorre.com/posts/rails-ultimate-install-guide-on-os-x-lion-using-rvm-homebrew-and-pow</a>
I went through a similar tutorial, and searching through google got me
though any problems I ran into.</p>

<p>This app is built using:</p>
<ul><li>
<p>Ruby 1.9.3-p125</p>
</li><li>
<p>Rails 3.2.3</p>
</li></ul>

<p>Using different versions of Ruby or Rails is known to cause some headaches.
They may be easily fixed, but I’ve never felt the need to try. Consider
yourself warned.</p>

<p>I <strong>strongly</strong> recommend using a nice GUI to help manage
everything. RubyMine is my weapon of choice: <a
href="http://www.jetbrains.com/ruby">www.jetbrains.com/ruby</a> It is easy
to use, very intelligent, and has great integration with GIT version
control systems. It also has tools to manage your versions of Ruby and
Gems, which are much easier to use than trying to do it all from the
Command Line. With this program, you can easily manage which Ruby SDKs you
are using and which are available, and make sure all Gems are up-to-date
and activated.</p>

<p>In addition, RubyMine has built in managers for data sources. It can be
difficult to connect RoR to your databases, and using this feature makes it
much easier.</p>

<h2 id="label-Databases">Databases</h2>

<p>Included in this package is a self contained SQLite3 table, and a script
that will create a MySQL database and table. Since required gems are
dependant on local libraries, SQLite3 and MySQL will need to be installed
on your machine in order for this to work. If you really don’t want to
install them, you must change requirements in
<strong>/config/Gemfile</strong> All necessary connection gems and database
configurations for these databases are included.</p>

<p>The SQLite3 database is self contained, and is located in
<strong>/db/sqlite_test.sqlite3</strong>. It should be found and connected
to automatically. It is a simple and small table, where each column is a
variable which can be plotted against other columns.</p>

<p>The MySQL database is populated using the text-file:
<strong>/CreateTestTable.txt</strong></p>

<p>To populate your MySQL database, simply run:</p>

<pre>&gt;&gt;mysql &lt; /dir/to/app/CreateTestTable.txt</pre>

<p>This will build a MySQL test database and table full of stock market data.
An important difference between the MySQL and the SQLite3 database is in
the schema. Where the SQLite3 database just has numeric columns to plot
against each-other, the MySQL database has a column of strings, which will
be used to filter the rows within columns to plot. This is because for a
database full of stock market stats, you will have lots of the same
variables *(open, close, volume, ect)* for a variety of stock market
symbols. The difference may seem moot, but it really represents a totally
different approach to data fetching and plotting. The two databases
together will show how this app can handle both with ease.</p>

<p>Connecting the database to Rails often is difficult. Error like “database
configuration does not specify adapter” pop up even when the configurations
are all correct. Fixing these errors often seems like magic. Simple
restarts sometimes fixes them. More often then not, digging through the
interweb is the best way to solve these errors.</p>

<h2 id="label-The+All+Clear">The All Clear</h2>

<p>Basically, you’ll know everything is working correctly when you can
successfully run the rails console, and typing:</p>

<pre>Plot.first</pre>

<p>Returns the first row in your database. Once this works for both of the
provided databases (switching between will be covered shortly), you should
be good to go!</p>

<p>Next, either from the command line or using
<strong>tools/bundle/install</strong> in RubyMine, run:</p>

<pre>bundle install</pre>

<p>to install all gems required for this app. If any fail to install, it is
likely an issue with your environment setup.</p>

<h1 id="label-Take+it+for+a+Test+Drive">Take it for a Test Drive</h1>

<p>Once everything is installed correctly (a never ending struggle), its time
to try it out! I’ll walk you through how to use the app for each database.
Hopefully this will illustrate how simple it will be to connect to your own
database. The RoR connection specifications for both can be found in
<strong>/config/database.yml</strong>. This is where you will put
connection information for your own database.</p>

<p>Normally, creating a web server designed to plot data from a database takes
months to setup and lots of tweaking and tinkering. Then, say you want to
start over with an entirely different database server and a completely
different table schema. Most of the time, this requires a lot of
modification to your server, if not a whole new setup.</p>

<p>Keeping that in mind, this app was designed to make this transition
especially easy, as I will illustrate below.</p>

<h2 id="label-SQLite+Database">SQLite Database</h2>

<p>(need to migrate and seed?)</p>

<p>This is a database built in Rails, populated in the
<strong>/db/seeds.rb</strong>. You can easily add or change the values in
this file, and update the database with:</p>

<pre>&gt;&gt;rake db:seed</pre>

<p>This is a small, simple database. Each column contains a single variable,
which can be plotted against other columns. Configuring the app to run on
this database happens in three places: *Database Specs –&gt;
/config/database.yml *Model          –&gt; /app/models/plot.rb *Controller 
–&gt; /app/controllers/plots_controller.rb</p>

<h3 id="label-Database+Specs">Database Specs</h3>

<p>This is where you tell Rails how to connect to your database This section
has been filled out for you. Look at <strong>/config/database.yml</strong>
and examine the database environment:</p>

<pre>sqlite_test:</pre>

<p>Everything needed should be included there, and should connect
automatically to the SQLite3 database.</p>

<h3 id="label-Model">Model</h3>

<p>This class definition is where you tell Ruby how to interpret and work with
database data. This really is the ‘meat and potatoes’ of the plotting app.
The methods and code within is what turns a connection to a database into a
epic interactive plotting experience.</p>

<p>In the *Database Specs* section, you told RoR <strong>how</strong> to
connect to your database. Here, you must give a few specifics about
<strong>what</strong> you are connecting to.</p>

<p>Now, edit/examine the *Database Table Specifications* section (near the top
of the file). Two subsections have been pre-defined. Make sure the MySQL
section (1.0) is all commented out, and the SQLite3 section (2.0) is
uncommented. It should look like this:</p>

<pre class="ruby"><span class="ruby-comment"># 2.0</span>
<span class="ruby-comment">#SQLITE test development environment</span>
<span class="ruby-identifier">establish_connection</span> :<span class="ruby-identifier">sqlite_test</span>                     <span class="ruby-comment"># The connection specs in /config/database.yml</span>
<span class="ruby-identifier">set_table_name</span> <span class="ruby-string">&quot;plots&quot;</span>                                <span class="ruby-comment"># Table name defined in the &quot;CreateTestTable.txt&quot; script</span>
<span class="ruby-identifier">@@find_filter</span> = <span class="ruby-keyword">false</span>                                 <span class="ruby-comment"># Indicates that this database will require column filtering (No for unique columns)</span>
<span class="ruby-identifier">@@default_x</span>       = [<span class="ruby-string">&quot;&quot;</span>]                              <span class="ruby-comment"># Default selection for X axis</span>
<span class="ruby-identifier">@@default_y</span>       = [<span class="ruby-string">&quot;&quot;</span>]                              <span class="ruby-comment"># Default selection(s) for Y axis</span>
<span class="ruby-identifier">@@default_filter</span>  = [<span class="ruby-string">&quot;&quot;</span>]                              <span class="ruby-comment"># Default selection(s) for FILTER selection</span>
<span class="ruby-identifier">@@default_feature</span> = [<span class="ruby-string">&quot;&quot;</span>]                              <span class="ruby-comment"># Default selection for interaction FEATURE</span>
</pre>

<p>The first two lines tell RoR which connection (of all listed in the
<strong>/config/database.yml</strong> file) to connect to, and which table
to use in that database connection.</p>

<p>The next 5 lines are optional.</p>
<ul><li>
<p>@@find_filter is an indicator, and should be set if your column relations
are not unique. See *Filter Explanation* below</p>
</li></ul>

<p>for a better description of this. If not set, there will be no filter
applied automatically.</p>
<ul><li>
<p>@@default_* can be used when you know more about your database. They hold
what you would like to be the options selected</p>
</li></ul>

<p>by default in the HTML page where you choose plot options. Now, they are
blank, if undefined, this program will set them to [“”] automatically.</p>

<h2 id="label-New+parts%3F%3F%3F%3F%3F+Or+Scopes%3F%3F">New parts????? Or Scopes??</h2>

<h3 id="label-Controller">Controller</h3>

<p>This file handles the querying of the database, and provides data to an
HTML page for rendering.</p>

</div>



<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

